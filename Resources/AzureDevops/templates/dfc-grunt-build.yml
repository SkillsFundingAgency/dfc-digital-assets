parameters:
  displayPrefix: '' # Optional prefix to displayName (useful if this is being called multiple times from the same build)
  npmfolder: '' # folder containing packages.json and gruntfile
  gruntfile: 'gruntfile.js'
  publishpath: '' # path to publish (publish step does not run if not specified)
  publishname: 'grunt_artifact'

steps:

# version check
- task: powershell@2
  displayName: '${{ parameters.displayPrefix }} Show npm version'
  inputs:
    workingDirectory: '${{ parameters.npmfolder }}'
    targetType: inline
    script: |
      npm --version
      npm install
      ${{ parameters.npmfolder }}/node_modules/grunt/grunt --gruntfile ${{ parameters.gruntfile }}

# Publish step only if a publish path has been provided
- ${{ if parameters.publishpath }}:
  # publish
  - task: PublishBuildArtifacts@1
    displayName: '${{ parameters.displayPrefix }} Publish Artifact: ${{ parameters.publishname }}'
    inputs:
      pathtoPublish: '${{ parameters.npmfolder }}/${{ parameters.publishpath }}'
      artifactName: '${{ parameters.publishname }}'